function a0_0xa2cb(_0x552895,_0xfba95f){_0x552895=_0x552895-0x165;const _0x58e32f=a0_0x58e3();let _0xa2cb1b=_0x58e32f[_0x552895];return _0xa2cb1b;}const a0_0x4f5ddc=a0_0xa2cb;(function(_0x3173a7,_0x2d8da4){const _0x44826e=a0_0xa2cb,_0x4b224d=_0x3173a7();while(!![]){try{const _0xd00f31=parseInt(_0x44826e(0x1ac))/0x1+-parseInt(_0x44826e(0x1af))/0x2*(-parseInt(_0x44826e(0x169))/0x3)+parseInt(_0x44826e(0x1b3))/0x4*(-parseInt(_0x44826e(0x1b5))/0x5)+parseInt(_0x44826e(0x178))/0x6+parseInt(_0x44826e(0x1b4))/0x7*(-parseInt(_0x44826e(0x190))/0x8)+-parseInt(_0x44826e(0x18a))/0x9*(parseInt(_0x44826e(0x185))/0xa)+parseInt(_0x44826e(0x17d))/0xb;if(_0xd00f31===_0x2d8da4)break;else _0x4b224d['push'](_0x4b224d['shift']());}catch(_0x30519b){_0x4b224d['push'](_0x4b224d['shift']());}}}(a0_0x58e3,0x4154d));const express=require('express'),cors=require(a0_0x4f5ddc(0x17c)),helmet=require(a0_0x4f5ddc(0x18c)),morgan=require('morgan'),mongoose=require('mongoose'),http=require('http'),{Server}=require('socket.io');require(a0_0x4f5ddc(0x1ae))['config']();const {scrubPII}=require(a0_0x4f5ddc(0x177)),AuditLog=require(a0_0x4f5ddc(0x18d)),app=express(),server=http['createServer'](app),io=new Server(server,{'cors':{'origin':'*'}});function a0_0x58e3(){const _0x2ea91a=['dev','8gusHYX','/api/v1/logs','[INCIDENT_REPORT]\x20Type:\x20','length','body','security-alert','%\x20|\x20Violation:\x20','catch','\x20|\x20Score:\x20','save','QS_WATERMARK_SYNCED','UNAUTHORIZED_ENTITY','error','STANDBY','env','OPTIMAL','Extension_User','get','/api/v1/vision-status','mongodb://127.0.0.1:27017/shieldai','MONGO_URI','Alert\x20Logging\x20Failed','connect','[ENV]\x20Database:\x20','message','--------------------------------------------------','ENDPOINT_AGENT','\x20|\x20Signature:\x20','451933BuFbXb','listen','dotenv','4HJqlvj','/api/v1/scrub','sanitized','/api/v1/toggle-vision','780188NxngFN','2445653ceiyKW','10yhTnrq','toISOString','[CORE_READY]\x20ShieldAI\x20Sovereign\x20Node:\x20Port\x20','threats','connection','ADMIN_CONSOLE','readyState','LOG_FETCH_FAILURE','206148XRuJml','[WATCHDOG]\x20Extension\x20Heartbeat\x20Monitor\x20Enabled','status','post','emit','then','/api/v1/alert','\x20(Quantum-Safe\x20Protected)','[SYSTEM_CMD]\x20Vision\x20Monitoring:\x20','[DATABASE]\x20Critical\x20Error:','_id','CONNECTED','now','use','./utils/scrubber.js','1365780UZwBLK','isViolation','find','integrityScore','cors','2514182oldLfx','ACKNOWLEDGED','timestamp','CRITICAL','/api/v1/heartbeat','[DATABASE]\x20Connection\x20established:\x20SECURE','[CRITICAL_FAILURE]','json','384870OGdxSm','log','HIGH','SYSTEM_ALARM','PAYLOAD_EMPTY','9EpGhhY','limit','helmet','./models/AuditLog','ACTIVE'];a0_0x58e3=function(){return _0x2ea91a;};return a0_0x58e3();}app[a0_0x4f5ddc(0x176)](helmet()),app[a0_0x4f5ddc(0x176)](cors()),app[a0_0x4f5ddc(0x176)](morgan(a0_0x4f5ddc(0x18f))),app[a0_0x4f5ddc(0x176)](express['json']());let isVisionActive=![],lastExtensionHeartbeat=Date[a0_0x4f5ddc(0x175)]();mongoose[a0_0x4f5ddc(0x1a6)](process['env'][a0_0x4f5ddc(0x1a4)]||a0_0x4f5ddc(0x1a3))[a0_0x4f5ddc(0x16e)](()=>console[a0_0x4f5ddc(0x186)](a0_0x4f5ddc(0x182)))[a0_0x4f5ddc(0x197)](_0x358a10=>console[a0_0x4f5ddc(0x186)](a0_0x4f5ddc(0x172),_0x358a10[a0_0x4f5ddc(0x1a8)])),app[a0_0x4f5ddc(0x16c)](a0_0x4f5ddc(0x181),(_0x21e31b,_0x52015d)=>{const _0x45de12=a0_0x4f5ddc;lastExtensionHeartbeat=Date[_0x45de12(0x175)](),_0x52015d[_0x45de12(0x184)]({'status':_0x45de12(0x17e),'timestamp':new Date()});}),setInterval(()=>{const _0x3e71dd=a0_0x4f5ddc,_0x51a2a9=Date[_0x3e71dd(0x175)]()-lastExtensionHeartbeat;_0x51a2a9>0xafc8&&io['emit'](_0x3e71dd(0x195),{'message':'ENDPOINT_TAMPERED:\x20Extension\x20disconnected/disabled','level':_0x3e71dd(0x180),'timestamp':new Date()});},0x2710),app['get'](a0_0x4f5ddc(0x1a2),(_0x161444,_0x16c9d5)=>{const _0x311b87=a0_0x4f5ddc;_0x16c9d5[_0x311b87(0x184)]({'active':isVisionActive,'system_health':_0x311b87(0x19f)});}),app[a0_0x4f5ddc(0x16c)](a0_0x4f5ddc(0x1b2),(_0x21da02,_0x22a05e)=>{const _0x227947=a0_0x4f5ddc,{status:_0x42864e}=_0x21da02[_0x227947(0x194)];isVisionActive=_0x42864e,console[_0x227947(0x186)](_0x227947(0x171)+(isVisionActive?_0x227947(0x18e):_0x227947(0x19d))),_0x22a05e[_0x227947(0x184)]({'success':!![],'active':isVisionActive});}),app[a0_0x4f5ddc(0x16c)](a0_0x4f5ddc(0x16f),async(_0x1ab610,_0x1c7ee9)=>{const _0xa40afd=a0_0x4f5ddc,{type:_0xd88afa,item:_0x152516,severity:_0x1eda99,trace_signature:_0x356f13,engine_runtime:_0x188e89}=_0x1ab610[_0xa40afd(0x194)],_0x560bd6=_0x356f13===_0xa40afd(0x19a)?'AI_ENGINE_PROXIMITY':'GENERIC_SENSOR';console[_0xa40afd(0x186)](_0xa40afd(0x192)+_0xd88afa+_0xa40afd(0x1ab)+(_0x356f13||'NONE')+'\x20|\x20Severity:\x20'+(_0x1eda99||_0xa40afd(0x187))),io[_0xa40afd(0x16d)]('security-alert',{'message':_0xd88afa+':\x20'+_0x152516+(_0x356f13?_0xa40afd(0x170):''),'level':_0x1eda99||_0xa40afd(0x180),'timestamp':new Date()[_0xa40afd(0x1b6)](),'runtime':_0x188e89});try{const _0xade45c=new AuditLog({'userId':_0xa40afd(0x188),'originalLength':0x0,'cleanLength':0x0,'threatsDetected':[_0xd88afa],'source':_0x560bd6,'integrityScore':0x0});await _0xade45c[_0xa40afd(0x199)]();}catch(_0x2d5c92){console[_0xa40afd(0x19c)](_0xa40afd(0x1a5),_0x2d5c92);}_0x1c7ee9[_0xa40afd(0x16b)](0xc8)[_0xa40afd(0x184)]({'status':'SIGNAL_BROADCAST_SUCCESS'});}),app[a0_0x4f5ddc(0x1a1)](a0_0x4f5ddc(0x191),async(_0x3b0667,_0x2aecd5)=>{const _0xcef7d0=a0_0x4f5ddc;try{const _0x57e3ac=await AuditLog[_0xcef7d0(0x17a)]()['sort']({'timestamp':-0x1})[_0xcef7d0(0x18b)](0xf);_0x2aecd5[_0xcef7d0(0x184)](_0x57e3ac);}catch(_0x7e1850){_0x2aecd5[_0xcef7d0(0x16b)](0x1f4)[_0xcef7d0(0x184)]({'error':_0xcef7d0(0x168)});}}),app[a0_0x4f5ddc(0x16c)](a0_0x4f5ddc(0x1b0),async(_0x110d6d,_0x5b5997)=>{const _0xe30ee5=a0_0x4f5ddc;try{const {prompt:_0x38c0fd,userId:_0x30b5f0,source:_0x471aba}=_0x110d6d[_0xe30ee5(0x194)];if(!_0x38c0fd)return _0x5b5997[_0xe30ee5(0x16b)](0x190)[_0xe30ee5(0x184)]({'error':_0xe30ee5(0x189)});const _0x28b84e=scrubPII(_0x38c0fd),_0x3931d1=_0x471aba||(_0x30b5f0===_0xe30ee5(0x1a0)?_0xe30ee5(0x1aa):_0xe30ee5(0x166)),_0x3830c7=new AuditLog({'userId':_0x30b5f0||_0xe30ee5(0x19b),'originalLength':_0x38c0fd[_0xe30ee5(0x193)],'cleanLength':_0x28b84e[_0xe30ee5(0x1b1)][_0xe30ee5(0x193)],'threatsDetected':_0x28b84e[_0xe30ee5(0x1b8)],'source':_0x3931d1,'integrityScore':_0x28b84e[_0xe30ee5(0x17b)]});await _0x3830c7[_0xe30ee5(0x199)](),console['log']('[DATA_TRAFFIC]\x20Origin:\x20'+_0x3931d1+_0xe30ee5(0x198)+_0x28b84e[_0xe30ee5(0x17b)]+_0xe30ee5(0x196)+_0x28b84e[_0xe30ee5(0x179)]),_0x5b5997[_0xe30ee5(0x184)]({'secured':_0x28b84e[_0xe30ee5(0x1b1)],'timestamp':_0x3830c7[_0xe30ee5(0x17f)],'logId':_0x3830c7[_0xe30ee5(0x173)],'integrityScore':_0x28b84e[_0xe30ee5(0x17b)],'isThreat':_0x28b84e['isViolation']});}catch(_0x1f50fc){console[_0xe30ee5(0x19c)](_0xe30ee5(0x183),_0x1f50fc),_0x5b5997[_0xe30ee5(0x16b)](0x1f4)[_0xe30ee5(0x184)]({'error':'INTERNAL_TUNNEL_ERROR'});}});const PORT=process[a0_0x4f5ddc(0x19e)]['PORT']||0x1388;server[a0_0x4f5ddc(0x1ad)](PORT,()=>{const _0x2131e1=a0_0x4f5ddc;console['log'](_0x2131e1(0x1a9)),console['log'](_0x2131e1(0x1b7)+PORT),console[_0x2131e1(0x186)](_0x2131e1(0x16a)),console['log'](_0x2131e1(0x1a7)+(mongoose[_0x2131e1(0x165)][_0x2131e1(0x167)]===0x1?_0x2131e1(0x174):'STANDBY')),console[_0x2131e1(0x186)](_0x2131e1(0x1a9));});